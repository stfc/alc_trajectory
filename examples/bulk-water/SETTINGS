#############################################################################################################
# This explanatory example defines the settings to analyse a NVE trajectory for a model composed of 64 water
# molecules in a cubic box. This is an example of a NON-REACTIVE system.
# The user can use a ASE to visualise the generated TRAJECTORY file. 
# Due to restrictions in the size of files to be stored in the repository, the trajectory is only 30 ps long,
# rather short for a rigorous analysis. For this reason, the present case shall be regarded as an example application
# For more details, the user is referred to the  use_code.md file of the root directory. Comments are preceded with 
# the symbol "#". The following blocks and directives do not have to comply with the order of appearance below. 
# They are just ordered this way only for explanatory purposes, and consistent with the use_code.md file.
#
# Acronyms:
# OCF: Orientational Correlation Function
# RDF: Radial Distribution Function
# MSD: Mean Square Displacement
#
##################################################################################################

#####################
#####################
###
### MODEL settings                                     
###
#####################
#####################

input_geometry_format   xyz                       # Format for the atomic configurations.

##### The &input_composition block: tagging the atomic species. 
## This block is necessary to relate the atomic elements of the model to different chemical environments. 
&input_composition                                
  atomic_species  2                               #  Total number of different atomic species. 
  tags       Hw   Ow                              #  Each of the 2 tags. Each frame of the TRAJECTORY file should list the positions of the 128 "Hw" atoms, followed by positions of the 64 "Ow" atoms
  amounts    128   64                             #  Number of atoms of each tag
  elements    H   O                               #  Chemical elements corresponding to each tag 
&end_input_composition                            #
## IMPORTANT: the order for the definition of     #
## tags, amounts and elements can be ANY          #.
###################################################

cell_units   Angstrom                             #  Units for the simulation cell defined in the &simulation_cell block. Valid units: Angstrom and Bohr

##### The &simulation_cell block: definition of the simulation cell, only needed for trajectories in xyz format
&simulation_cell                                  #
 12.420000   0.0000000   0.00000                  #  A(1,1)    A(1,2)    A(1,3)                   
  0.000000  12.4200000   0.00000                  #  A(2,1)    A(2,2)    A(2,3)
  0.000000   0.0000000  12.42000                  #  A(3,1)    A(3,2)    A(3,3)
&end_simulation_cell                              #
###################################################

##### The &monitored_species block. This blocks defines the particular type of species to "monitor" along the trajectory
# The defined species MUST NOT be the changing chemical species
&monitored_species
  name H2O                                        # Name of the species. In this case water.
  reference_tag Ow                                # Only Ow atoms will be part of water. Ow sites can also form chemical species as described above
  &atomic_components                              ##### This is to define the atomic composition of the monitored species. For the case of water it is obvious, but the structure of the block allows defining more complex structures:
    number_components 2                           # Number of atomic components (H and O)
    H  2                                          # 2 H atoms
    O  1                                          # 1 O atom
  &end_atomic_components                          #####
  bond_cutoff  1.2 Angstrom                       # The maximum distance criteria for atomic bonding in this species is 1.2 Angstrom. Units can also be in "Bohr" 
&end_monitored_species                            
#############################################################################################

######################################
######################################
###
### TRAJECTORY settings for analysis                                         
###
######################################
######################################

ensemble   NVE                #  Type of ensemble. Options: NVE, NVT, NPT 
timestep   10  fs             #  Time step of the recoderd trajectory, which is not necessarily the same as the time step to integrated the MD equations. Valid units: fs and ps. In this case, timestep could also be set to "0.010 ps"

#### The &rdf block: computes the RDF for the species defined
&rdf                                              
 dr 0.02  Angstrom                                # Use a distance discretization of 0.02 Angstrom
 tags_species_a  1  Ow                            # Defines the tags of species a
 tags_species_b  1  Ow                            # Defines the tags of species b
&end_rdf                                          
####

#### The &data_analysis block: instructs the code how to process and segment the trajectory for the computation of the TCF, MSD and OCF.
## The directive "overlap_interval" is convenient to average quantities. 
## Computed averages will be printed to TCF_AVG, MSD_AVG and OCF_AVG files, as long as the blocks &lifetime, &msd and &ocf are defined (see below)
&data_analysis                                    
  time_interval   10.0  ps                        # Take time segments of 10 ps
  overlap_time    0.50  ps                        # Initialise a new analysis every 0.50 ps. This is convenient to average computed quantities, whose values will be printed to TCF_AVG, MSD_AVG and OCF_AVG
  ignore_initial  2.00  ps                        # Ignore the first 2 ps of the trajectory  
&end_data_analysis                                #
###################################################

#### The &lifetime block: in this case it is not meaningful. This example corresponds to a model of 64 non-reactive water molecules

#### The &msd block: computes the MSD for the monitored species defined in the &monitored_species block. 
&msd                                              
  select xyz                                      # Compute the MSD. Other available options are: x, y, z, xy, xz, yz and yz
  pbc_xyz   T  T  T                               # Instructs is PBCs are applied to each coordinate or not 
&end_msd                                          
####

#### The &ocf block: computes the OCF for the monitored species
&ocf                                              
  legendre_order  2                               # Define the order of the Legendre polynomial.  
  u_definition    bond_123                        # Definition of the unit vector to evaluate the OCF. Options available are: bond_12, bond_13, bond_123, bond_12-13 and plane.
&end_ocf                                          
####
